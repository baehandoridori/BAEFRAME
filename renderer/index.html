<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: blob:;">
  <title>배프레임 - For Studio JBBJ - by BAE</title>
  <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles/main.css">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-left">
      <div class="logo">
        <div class="logo-icon">B</div>
        <span>baeframe</span>
      </div>
      <div class="file-info" id="fileInfo">
        <span class="file-icon">
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"/>
            <line x1="7" y1="2" x2="7" y2="22"/>
            <line x1="17" y1="2" x2="17" y2="22"/>
            <line x1="2" y1="12" x2="22" y2="12"/>
            <line x1="2" y1="7" x2="7" y2="7"/>
            <line x1="2" y1="17" x2="7" y2="17"/>
            <line x1="17" y1="7" x2="22" y2="7"/>
            <line x1="17" y1="17" x2="22" y2="17"/>
          </svg>
        </span>
        <span class="file-name file-name-clickable" id="fileName">파일을 열어주세요</span>
        <span class="file-path" id="filePath"></span>
        <!-- Version Dropdown -->
        <div class="version-dropdown" id="versionDropdown" style="display: none;">
          <button class="version-dropdown-trigger" id="versionDropdownTrigger">
            <span class="version-badge-icon">📦</span>
            <span class="version-badge-label" id="versionBadge">v1</span>
            <svg class="version-dropdown-arrow" viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6 9 12 15 18 9"/>
            </svg>
          </button>
          <div class="version-dropdown-menu" id="versionDropdownMenu">
            <div class="version-dropdown-header">
              <span>버전 목록</span>
              <div class="version-header-actions">
                <button class="version-header-btn" id="btnAddManualVersion" title="수동 버전 추가">
                  <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
                  </svg>
                </button>
                <button class="version-header-btn" id="btnRescanVersions" title="폴더 다시 스캔">
                  <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="23 4 23 10 17 10"/><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
                  </svg>
                </button>
                <span class="version-count" id="versionCount">0</span>
              </div>
            </div>
            <div class="version-list" id="versionList">
              <!-- 버전 목록이 여기에 렌더링됨 -->
            </div>
            <div class="version-dropdown-divider"></div>
            <button class="version-dropdown-action version-compare-btn" id="btnCompareVersions">
              <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="7" height="18" rx="1"/>
                <rect x="14" y="3" width="7" height="18" rx="1"/>
              </svg>
              버전 비교
            </button>
          </div>
        </div>
      </div>
    </div>
    <div class="header-right">
      <!-- 협업자 표시 -->
      <div class="collaborators-indicator" id="collaboratorsIndicator" style="display: none;">
        <div class="collaborators-avatars" id="collaboratorsAvatars">
          <!-- 협업자 아바타가 여기에 동적으로 추가됨 -->
        </div>
        <div class="collaborators-info">
          <span class="collaborators-count" id="collaboratorsCount">0</span>
          <span class="collaborators-label">명 작업 중</span>
        </div>
        <div class="sync-status" id="syncStatus" title="동기화 상태">
          <svg class="sync-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M23 4v6h-6"></path>
            <path d="M1 20v-6h6"></path>
            <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10"></path>
            <path d="M20.49 15a9 9 0 0 1-14.85 3.36L1 14"></path>
          </svg>
        </div>
      </div>
      <button class="btn btn-secondary" id="btnOpenFolder" title="폴더 열기 (탐색기에서 보기)" style="display: none;">
        <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
        </svg>
        폴더 열기
      </button>
      <button class="btn btn-secondary" id="btnOpenOther" title="다른 영상 파일 열기" style="display: none;">
        <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
          <polyline points="14 2 14 8 20 8"/>
          <polygon points="10 12 10 18 15 15 10 12"/>
        </svg>
        다른 파일
      </button>
      <button class="btn btn-secondary" id="btnSave">
        <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
          <polyline points="17 21 17 13 7 13 7 21"/>
          <polyline points="7 3 7 8 15 8"/>
        </svg>
        저장
      </button>
      <button class="btn btn-primary" id="btnCopyLink">
        <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
          <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
        </svg>
        링크 복사
      </button>
    </div>
  </header>

  <!-- Main Container -->
  <div class="main-container">
    <!-- Viewer Section -->
    <div class="viewer-section" id="viewerSection">
      <!-- Video Viewer -->
      <div class="viewer-container" id="viewerContainer">
        <div class="video-wrapper" id="videoWrapper">
          <!-- 드롭 존 -->
          <div class="drop-zone" id="dropZone">
            <div class="drop-zone-content">
              <img class="drop-zone-logo" src="assets/logo/baeframe.png" alt="BAEFRAME" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
              <div class="drop-zone-icon" style="display: none;">
                <svg viewBox="0 0 24 24" width="48" height="48" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                  <rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"/>
                  <line x1="7" y1="2" x2="7" y2="22"/>
                  <line x1="17" y1="2" x2="17" y2="22"/>
                  <line x1="2" y1="12" x2="22" y2="12"/>
                  <line x1="2" y1="7" x2="7" y2="7"/>
                  <line x1="2" y1="17" x2="7" y2="17"/>
                  <line x1="17" y1="7" x2="22" y2="7"/>
                  <line x1="17" y1="17" x2="22" y2="17"/>
                </svg>
              </div>
              <div class="drop-zone-text">영상 파일을 여기에 드롭하세요</div>
              <div class="drop-zone-hint">MOV, MP4, H.264/265 지원</div>
              <button class="btn btn-primary btn-large" id="btnOpenFile">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polygon points="5 3 19 12 5 21 5 3"/>
                </svg>
                영상 열기
              </button>
            </div>
          </div>

          <!-- Video Element (추후 mpv로 대체) -->
          <video id="videoPlayer" style="display: none;"></video>

          <!-- TODO: 영상 어니언 스킨 캔버스 - 비디오 가림 문제로 임시 비활성화
          <canvas id="videoOnionSkinCanvas"></canvas>
          -->

          <!-- Video Loading Overlay -->
          <div class="video-loading-overlay" id="videoLoadingOverlay">
            <div class="loading-spinner"></div>
            <div class="loading-text" id="loadingText">썸네일 생성 중...</div>
            <div class="loading-progress-bar">
              <div class="loading-progress-fill" id="loadingProgressFill"></div>
            </div>
          </div>

          <!-- Codec Unsupported Overlay -->
          <div class="codec-error-overlay" id="codecErrorOverlay">
            <div class="codec-error-icon">⚠️</div>
            <div class="codec-error-title">지원하지 않는 코덱</div>
            <div class="codec-error-message">이 영상은 지원하지 않는 코덱(MPEG-4 Part 2, HEVC 등)입니다.</div>
            <div class="codec-error-hint">H.264 코덱으로 변환 후 다시 열어주세요.</div>
            <button class="btn btn-secondary" id="btnCodecErrorClose">다른 영상 열기</button>
          </div>

          <!-- App Saving Overlay (종료 전 저장) -->
          <div class="app-saving-overlay" id="appSavingOverlay">
            <div class="saving-spinner"></div>
            <div class="saving-text">저장 중...</div>
            <div class="saving-hint">잠시만 기다려주세요</div>
          </div>

          <!-- Transcode Overlay (코덱 변환) -->
          <div class="transcode-overlay" id="transcodeOverlay">
            <div class="transcode-icon">🔄</div>
            <div class="transcode-title">비디오 변환 중</div>
            <div class="transcode-subtitle" id="transcodeSubtitle">MPEG-4 → H.264</div>
            <div class="transcode-progress-bar">
              <div class="transcode-progress-fill" id="transcodeProgressFill"></div>
            </div>
            <div class="transcode-info">
              <span id="transcodePercent">0%</span>
              <span id="transcodeStatus">변환 준비 중...</span>
            </div>
            <button class="btn btn-secondary" id="btnCancelTranscode">취소</button>
          </div>

          <!-- Onion Skin Canvas (그리기 캔버스 아래에 표시) -->
          <canvas id="onionSkinCanvas" class="drawing-overlay onion-skin-layer"></canvas>

          <!-- Drawing Overlay Canvas -->
          <canvas id="drawingCanvas" class="drawing-overlay"></canvas>

          <!-- Comment Range Overlay (비디오 하단 댓글 범위 표시) -->
          <div class="video-comment-range-overlay" id="videoCommentRangeOverlay">
            <!-- 댓글 범위 요소들이 여기에 동적으로 추가됨 -->
          </div>

          <!-- Comment Range Overlay Controls -->
          <div class="video-comment-overlay-controls" id="videoCommentOverlayControls">
            <button class="overlay-control-btn" id="btnOverlayToggle" title="댓글 범위 표시 토글">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
              </svg>
            </button>
            <button class="overlay-control-btn" id="btnOverlayPosition" title="위치 전환 (상단/하단)">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M7 10l5-5 5 5"/>
                <path d="M7 14l5 5 5-5"/>
              </svg>
            </button>
          </div>

          <!-- Video Zoom Controls -->
          <div class="video-zoom-controls" id="videoZoomControls">
            <button class="video-zoom-btn" id="btnVideoZoomOut" title="축소">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/><line x1="8" y1="11" x2="14" y2="11"/></svg>
            </button>
            <span class="video-zoom-display" id="videoZoomDisplay">100%</span>
            <button class="video-zoom-btn" id="btnVideoZoomIn" title="확대">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/><line x1="11" y1="8" x2="11" y2="14"/><line x1="8" y1="11" x2="14" y2="11"/></svg>
            </button>
            <button class="video-zoom-btn" id="btnVideoZoomReset" title="원본 크기 (100%)">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/></svg>
            </button>
          </div>

          <!-- Zoom Indicator Overlay -->
          <div class="zoom-indicator-overlay" id="zoomIndicatorOverlay"></div>

          <!-- Drawing Tools Palette (이동/접기 가능) -->
          <div class="drawing-tools" id="drawingTools">
            <!-- 드래그 핸들 및 접기 버튼 -->
            <div class="drawing-tools-header" id="drawingToolsHeader">
              <span class="drag-handle" title="드래그하여 이동">
                <svg viewBox="0 0 24 24" width="14" height="14" fill="currentColor"><circle cx="9" cy="5" r="1.5"/><circle cx="15" cy="5" r="1.5"/><circle cx="9" cy="12" r="1.5"/><circle cx="15" cy="12" r="1.5"/><circle cx="9" cy="19" r="1.5"/><circle cx="15" cy="19" r="1.5"/></svg>
              </span>
              <span class="tools-title">그리기 도구</span>
              <button class="collapse-btn" id="collapseToolsBtn" title="접기/펴기">
                <svg viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
              </button>
            </div>

            <!-- 접히는 컨텐츠 영역 -->
            <div class="drawing-tools-content" id="drawingToolsContent">
              <!-- 도구 선택 -->
              <div class="tools-section">
                <div class="section-label">도구</div>
                <div class="tools-row">
                  <button class="tool-btn active" data-tool="pen" title="펜 (P)">
                    <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>
                  </button>
                  <button class="tool-btn" data-tool="brush" title="브러쉬 (B)">
                    <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M9.06 11.9l8.07-8.06a2.85 2.85 0 1 1 4.03 4.03l-8.06 8.08"/><path d="M7.07 14.94c-1.66 0-3 1.35-3 3.02 0 1.33-2.5 1.52-2 2.02 1.08 1.1 2.49 2.02 4 2.02 2.2 0 4-1.8 4-4.04a3.01 3.01 0 0 0-3-3.02z"/></svg>
                  </button>
                  <button class="tool-btn" data-tool="eraser" title="지우개 (E)">
                    <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21"/><path d="M22 21H7"/><path d="m5 11 9 9"/></svg>
                  </button>
                  <button class="tool-btn" data-tool="line" title="선 (L)">
                    <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="19" x2="19" y2="5"/></svg>
                  </button>
                  <button class="tool-btn" data-tool="arrow" title="화살표 (A)">
                    <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
                  </button>
                  <button class="tool-btn" data-tool="rect" title="사각형 (R)">
                    <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/></svg>
                  </button>
                  <button class="tool-btn" data-tool="circle" title="원 (O)">
                    <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/></svg>
                  </button>
                </div>
              </div>

              <!-- 브러쉬 사이즈 -->
              <div class="tools-section">
                <div class="section-label">크기 <span id="brushSizeValue">3px</span></div>
                <div class="size-slider-wrapper">
                  <input type="range" class="size-slider" id="brushSizeSlider" min="1" max="50" value="3">
                  <div class="size-preview" id="sizePreview"></div>
                </div>
              </div>

              <!-- 불투명도 (지우개 제외) -->
              <div class="tools-section" id="opacitySection">
                <div class="section-label">불투명도 <span id="brushOpacityValue">100%</span></div>
                <div class="size-slider-wrapper">
                  <input type="range" class="size-slider" id="brushOpacitySlider" min="10" max="100" value="100">
                </div>
              </div>

              <!-- 브러시 외곽선 -->
              <div class="tools-section" id="strokeSection">
                <div class="section-label">
                  외곽선
                  <button class="stroke-toggle" id="strokeToggle" title="외곽선 토글">OFF</button>
                </div>
                <div class="stroke-controls" id="strokeControls">
                  <div class="stroke-row">
                    <span>두께</span>
                    <input type="range" class="size-slider" id="strokeWidthSlider" min="1" max="10" value="3">
                    <span id="strokeWidthValue">3px</span>
                  </div>
                  <div class="stroke-row">
                    <span>색상</span>
                    <div class="stroke-colors">
                      <button class="stroke-color-btn active" data-stroke-color="#ffffff" style="background: #ffffff; border: 1px solid #555" title="하양"></button>
                      <button class="stroke-color-btn" data-stroke-color="#000000" style="background: #000000" title="검정"></button>
                      <button class="stroke-color-btn" data-stroke-color="#ff4757" style="background: #ff4757" title="빨강"></button>
                      <button class="stroke-color-btn" data-stroke-color="#ffd000" style="background: #ffd000" title="노랑"></button>
                    </div>
                  </div>
                </div>
              </div>

              <!-- 색상 선택 -->
              <div class="tools-section">
                <div class="section-label">색상</div>
                <div class="colors-row">
                  <button class="color-btn active" data-color="red" style="background: #ff4757" title="빨강"></button>
                  <button class="color-btn" data-color="yellow" style="background: #ffd000" title="노랑"></button>
                  <button class="color-btn" data-color="green" style="background: #26de81" title="초록"></button>
                  <button class="color-btn" data-color="blue" style="background: #4a9eff" title="파랑"></button>
                  <button class="color-btn" data-color="white" style="background: #ffffff; border: 1px solid #555" title="하양"></button>
                  <button class="color-btn" data-color="black" style="background: #000000" title="검정"></button>
                  <button class="color-btn" data-color="mint" style="background: #1abc9c" title="민트"></button>
                  <button class="color-btn" data-color="pink" style="background: #ff6b9d" title="핑크"></button>
                </div>
              </div>

              <!-- 그리기 어니언 스킨 -->
              <div class="tools-section">
                <div class="section-label">
                  그리기 어니언
                  <button class="onion-toggle" id="onionToggle" title="어니언 스킨 토글">OFF</button>
                </div>
                <div class="onion-controls" id="onionControls">
                  <div class="onion-row">
                    <span>이전</span>
                    <input type="number" id="onionBefore" min="0" max="5" value="2">
                    <span>장</span>
                  </div>
                  <div class="onion-row">
                    <span>이후</span>
                    <input type="number" id="onionAfter" min="0" max="5" value="1">
                    <span>장</span>
                  </div>
                  <div class="onion-row">
                    <span>투명도</span>
                    <input type="range" id="onionOpacity" min="10" max="80" value="30">
                    <span id="onionOpacityValue">30%</span>
                  </div>
                </div>
              </div>

              <!-- TODO: 영상 어니언 스킨 - 비디오 가림 문제로 임시 비활성화
              <div class="tools-section">
                <div class="section-label">
                  영상 어니언
                  <button class="onion-toggle" id="videoOnionToggle" title="영상 어니언 스킨 토글">OFF</button>
                </div>
                <div class="onion-controls" id="videoOnionControls">
                  <div class="onion-row">
                    <span>이전</span>
                    <input type="number" id="videoOnionBefore" min="0" max="5" value="1">
                    <span>장</span>
                  </div>
                  <div class="onion-row">
                    <span>이후</span>
                    <input type="number" id="videoOnionAfter" min="0" max="5" value="1">
                    <span>장</span>
                  </div>
                  <div class="onion-row">
                    <span>투명도</span>
                    <input type="range" id="videoOnionOpacity" min="10" max="60" value="30">
                    <span id="videoOnionOpacityValue">30%</span>
                  </div>
                </div>
              </div>
              -->

              <!-- 액션 버튼 -->
              <div class="tools-section tools-actions">
                <button class="tool-btn" id="btnUndo" title="실행 취소 (Ctrl+Z)">
                  <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 7v6h6"/><path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"/></svg>
                </button>
                <button class="tool-btn" id="btnClearDrawing" title="전체 지우기">
                  <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Resizer (Horizontal) -->
      <div class="resizer resizer-h" id="viewerResizer"></div>

      <!-- Playback Controls -->
      <div class="controls-bar">
        <!-- 전체화면 시크바 -->
        <div class="fullscreen-seekbar" id="fullscreenSeekbar">
          <div class="seekbar-track">
            <div class="seekbar-progress" id="seekbarProgress"></div>
            <div class="seekbar-handle" id="seekbarHandle"></div>
          </div>
        </div>
        <div class="playback-controls">
          <button class="control-btn" id="btnFirst" title="처음으로 (Home)">
            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><polygon points="19 20 9 12 19 4 19 20"/><line x1="5" y1="19" x2="5" y2="5"/></svg>
          </button>
          <button class="control-btn" id="btnPrevFrame" title="이전 프레임 (←)">
            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><polygon points="11 19 2 12 11 5 11 19"/><polygon points="22 19 13 12 22 5 22 19"/></svg>
          </button>
          <button class="control-btn play-btn" id="btnPlay" title="재생/일시정지 (Space)">
            <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" id="playIcon"><polygon points="5 3 19 12 5 21 5 3"/></svg>
          </button>
          <button class="control-btn" id="btnNextFrame" title="다음 프레임 (→)">
            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 19 22 12 13 5 13 19"/><polygon points="2 19 11 12 2 5 2 19"/></svg>
          </button>
          <button class="control-btn" id="btnLast" title="끝으로 (End)">
            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 4 15 12 5 20 5 4"/><line x1="19" y1="5" x2="19" y2="19"/></svg>
          </button>
        </div>

        <div class="timecode" id="timecode">
          <span class="timecode-current" id="timecodeCurrent">00:00:00:00</span>
          <span class="timecode-separator">/</span>
          <span class="timecode-total" id="timecodeTotal">00:00:00:00</span>
        </div>

        <div class="frame-indicator" id="frameIndicator">24fps · Frame 0 / 0</div>

        <div class="controls-spacer"></div>

        <div class="action-controls">
          <button class="action-btn" id="btnDrawMode">
            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>
            그리기
            <span class="shortcut-hint" id="btnDrawModeHint">D</span>
          </button>
          <div class="comment-nav-group">
            <button class="nav-arrow-btn" id="btnPrevComment" title="이전 댓글 (Shift+←)">
              <svg viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
            </button>
            <button class="action-btn" id="btnAddComment">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
              댓글 추가
              <span class="shortcut-hint" id="btnAddCommentHint">C</span>
            </button>
            <button class="nav-arrow-btn" id="btnNextComment" title="다음 댓글 (Shift+→)">
              <svg viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
            </button>
          </div>
        </div>

        <!-- TODO: 영상 어니언 스킨 토글 - 비디오 가림 문제로 임시 비활성화
        <button class="control-toggle-btn" id="btnVideoOnionSkin" title="영상 어니언 스킨 (단축키 없음)">
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10" opacity="0.3"/>
            <circle cx="12" cy="12" r="7" opacity="0.5"/>
            <circle cx="12" cy="12" r="4"/>
          </svg>
        </button>
        -->

        <!-- 구간 반복 컨트롤 -->
        <div class="loop-controls" id="loopControls">
          <button class="loop-btn" id="btnSetInPoint" title="시작점 설정 (I)">
            <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 19l-7-7 7-7"/><line x1="4" y1="12" x2="20" y2="12"/></svg>
            <span class="loop-timecode" id="inPointDisplay">--:--</span>
          </button>
          <button class="loop-btn loop-toggle" id="btnLoopToggle" title="구간 반복 (L)">
            <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><polyline points="17 1 21 5 17 9"/><path d="M3 11V9a4 4 0 0 1 4-4h14"/><polyline points="7 23 3 19 7 15"/><path d="M21 13v2a4 4 0 0 1-4 4H3"/></svg>
          </button>
          <button class="loop-btn" id="btnSetOutPoint" title="종료점 설정 (O)">
            <span class="loop-timecode" id="outPointDisplay">--:--</span>
            <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><path d="M13 5l7 7-7 7"/><line x1="20" y1="12" x2="4" y2="12"/></svg>
          </button>
          <button class="loop-btn loop-clear" id="btnClearLoop" title="구간 초기화">
            <svg viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
          </button>
        </div>

        <!-- 하이라이트 컨트롤 -->
        <div class="highlight-controls" id="highlightControls">
          <button class="nav-arrow-btn" id="btnPrevHighlight" title="이전 하이라이트 (Alt+←)">
            <svg viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
          </button>
          <button class="highlight-btn" id="btnAddHighlight" title="하이라이트 추가 (H)">
            <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="10" width="18" height="4" rx="1" fill="currentColor" opacity="0.3"/>
              <line x1="12" y1="6" x2="12" y2="18"/>
              <line x1="6" y1="12" x2="18" y2="12"/>
            </svg>
            <span>하이라이트</span>
          </button>
          <button class="nav-arrow-btn" id="btnNextHighlight" title="다음 하이라이트 (Alt+→)">
            <svg viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
          </button>
        </div>
      </div>

      <!-- Timeline -->
      <div class="timeline-section" id="timelineSection">
        <div class="timeline-toolbar">
          <div class="timeline-toolbar-left">
            <div class="timeline-title">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" style="color: var(--accent-primary)"><rect x="2" y="7" width="20" height="10" rx="2"/><line x1="6" y1="7" x2="6" y2="17"/><line x1="10" y1="7" x2="10" y2="17"/><line x1="14" y1="7" x2="14" y2="17"/><line x1="18" y1="7" x2="18" y2="17"/></svg>
              타임라인
            </div>
          </div>
          <div class="timeline-toolbar-right">
            <div class="zoom-buttons">
              <button class="zoom-btn" id="btnTimelineZoomOut" title="축소">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/></svg>
              </button>
              <button class="zoom-btn" id="btnTimelineZoomReset" title="원본 (100%)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/></svg>
              </button>
              <button class="zoom-btn" id="btnTimelineZoomIn" title="확대">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
              </button>
            </div>
            <div class="zoom-control">
              <span class="zoom-label">줌</span>
              <input type="range" class="zoom-slider" id="zoomSlider" min="1" max="100" value="50">
              <span class="zoom-display" id="zoomDisplay">100%</span>
            </div>
          </div>
        </div>

        <div class="timeline-main">
          <!-- Layer Headers -->
          <div class="layer-headers" id="layerHeaders">
            <div class="layer-header-ruler">
              <!-- 레이어 추가/삭제 버튼 -->
              <button class="layer-action-btn" id="btnAddLayer" title="레이어 추가">
                <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
              </button>
              <button class="layer-action-btn" id="btnDeleteLayer" title="레이어 삭제">
                <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/></svg>
              </button>
            </div>
            <!-- 하이라이트 트랙 헤더 (하이라이트 트랙과 연동) -->
            <div class="highlight-layer-header" id="highlightLayerHeader" style="display: none;">
              <span class="highlight-label">하이라이트</span>
            </div>
            <!-- 댓글 트랙 헤더 (댓글 트랙과 연동) -->
            <div class="comment-layer-header" id="commentLayerHeader" style="display: none;">
              <span class="comment-label">댓글</span>
            </div>
            <div class="layer-header" data-layer="video">
              <div class="layer-color" style="background: #3a3a3a"></div>
              <span class="layer-visibility">
                <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
              </span>
              <span class="layer-name">
                <svg viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 4px"><rect x="2" y="2" width="20" height="20" rx="2.18"/><line x1="7" y1="2" x2="7" y2="22"/><line x1="17" y1="2" x2="17" y2="22"/><line x1="2" y1="12" x2="22" y2="12"/></svg>
                Video
              </span>
              <span class="layer-lock">
                <svg viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
              </span>
            </div>
          </div>

          <!-- Timeline Tracks -->
          <div class="timeline-tracks" id="timelineTracks">
            <!-- 플레이헤드 (핸들 + 라인이 같은 부모에서 같은 left 값 사용) -->
            <div class="playhead-handle" id="playheadHandle"></div>
            <div class="playhead-line" id="playheadLine"></div>

            <div class="timeline-ruler" id="timelineRuler"></div>
            <div class="tracks-container" id="tracksContainer">
              <!-- 하이라이트 트랙 (하이라이트가 있을 때만 표시) -->
              <div class="highlight-track" id="highlightTrack" style="display: none;">
                <!-- 하이라이트 요소들이 여기에 동적으로 추가됨 -->
              </div>
              <!-- 댓글 트랙 (댓글이 있을 때만 표시) -->
              <div class="comment-track" id="commentTrack" style="display: none;">
                <!-- 댓글 범위 요소들이 여기에 동적으로 추가됨 -->
              </div>
              <div class="track-row">
                <div class="track-clip video" id="videoTrackClip">영상을 로드하세요</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Resizer (Vertical) -->
    <div class="resizer" id="panelResizer">
      <!-- Comment Panel Toggle Button -->
      <button class="comment-panel-toggle" id="commentPanelToggle" title="댓글 패널 토글">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
      </button>
    </div>

    <!-- Comment Panel -->
    <div class="comment-panel" id="commentPanel">
      <div class="panel-header">
        <div class="panel-title">
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" style="color: var(--accent-primary)"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
          댓글
          <span class="comment-count" id="commentCount">0</span>
        </div>
        <div class="panel-actions">
          <button class="panel-btn" id="btnCompactView" title="컴팩트 뷰 토글">
            <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><line x1="4" y1="6" x2="20" y2="6"/><line x1="4" y1="12" x2="20" y2="12"/><line x1="4" y1="18" x2="20" y2="18"/></svg>
          </button>
          <button class="panel-btn" id="btnCommentSettings" title="설정">
            <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
          </button>
          <!-- 설정 드롭다운 -->
          <div class="comment-settings-dropdown" id="commentSettingsDropdown">
            <div class="settings-dropdown-header">댓글 설정</div>
            <div class="settings-dropdown-item">
              <label class="settings-toggle">
                <input type="checkbox" id="toggleCommentThumbnails" checked>
                <span class="toggle-slider"></span>
                <span class="toggle-label">썸네일 표시</span>
              </label>
            </div>
            <div class="settings-dropdown-item thumbnail-scale-item" id="thumbnailScaleItem">
              <label class="settings-label">썸네일 크기</label>
              <div class="settings-scale-control">
                <input type="range" id="thumbnailScaleSlider" min="35" max="200" value="35" step="5">
                <span class="scale-value" id="thumbnailScaleValue">35%</span>
              </div>
            </div>
            <div class="settings-dropdown-divider"></div>
            <div class="settings-dropdown-item">
              <label class="settings-toggle">
                <input type="checkbox" id="toggleToastNotifications" checked>
                <span class="toggle-slider"></span>
                <span class="toggle-label">알림 표시</span>
              </label>
            </div>
            <div class="settings-dropdown-divider"></div>
            <button class="settings-dropdown-btn" id="btnChangeUserName">
              <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
              이름 변경
            </button>
            <button class="settings-dropdown-btn" id="btnShortcutSettings">
              <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="M6 8h.01M10 8h.01M14 8h.01M18 8h.01M6 12h12M6 16h8"/></svg>
              단축키 설정
            </button>
            <div class="settings-dropdown-divider"></div>
            <button class="settings-dropdown-btn" id="btnCacheSettings">
              <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg>
              캐시 설정
            </button>
          </div>
        </div>
      </div>

      <!-- 피드백 완료율 프로그레스 바 -->
      <div class="feedback-progress" id="feedbackProgress">
        <div class="feedback-progress-header">
          <span class="feedback-progress-label">피드백 진행률</span>
          <span class="feedback-progress-value" id="feedbackProgressValue">0%</span>
        </div>
        <div class="feedback-progress-bar">
          <div class="feedback-progress-fill" id="feedbackProgressFill" style="width: 0%"></div>
        </div>
      </div>

      <div class="filter-bar">
        <button class="filter-chip active" data-filter="all">전체</button>
        <button class="filter-chip" data-filter="unresolved">미해결</button>
        <button class="filter-chip" data-filter="resolved">해결됨</button>
      </div>

      <div class="comments-list" id="commentsList">
        <!-- 댓글들이 여기에 렌더링됨 -->
        <div class="empty-comments">
          <div class="empty-comments-icon">
            <svg viewBox="0 0 24 24" width="40" height="40" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
          </div>
          <div class="empty-comments-text">아직 댓글이 없습니다</div>
          <div class="empty-comments-hint">영상을 재생하고 C키를 눌러 댓글을 추가하세요</div>
        </div>
      </div>

      <!-- New Comment Input -->
      <div class="new-comment">
        <div class="comment-image-preview" id="commentImagePreview" style="display: none;">
          <img id="commentPreviewImg" src="" alt="첨부 이미지">
          <button class="comment-image-remove" id="commentImageRemove" title="이미지 제거">
            <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
          </button>
        </div>
        <div class="comment-input-wrapper">
          <textarea class="comment-input" id="commentInput" rows="2" placeholder="댓글을 입력하세요... (Ctrl+V로 이미지 붙여넣기)"></textarea>
          <div class="comment-input-actions">
            <button class="comment-image-btn" id="btnCommentImage" title="이미지 첨부">
              <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><path d="M21 15l-5-5L5 21"/></svg>
            </button>
            <button class="comment-submit" id="btnSubmitComment">전송</button>
          </div>
        </div>
        <div class="input-hint">Tip: 그리기 도구(D)로 마킹을 추가하거나 이미지를 붙여넣어 피드백을 추가하세요</div>
      </div>
    </div>
  </div>

  <!-- Shortcuts Toggle Button -->
  <button class="shortcuts-toggle" id="shortcutsToggle" title="단축키 (?)">
    <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="4" width="20" height="16" rx="2"/><line x1="6" y1="8" x2="6.01" y2="8"/><line x1="10" y1="8" x2="10.01" y2="8"/><line x1="14" y1="8" x2="14.01" y2="8"/><line x1="18" y1="8" x2="18.01" y2="8"/><line x1="6" y1="12" x2="6.01" y2="12"/><line x1="10" y1="12" x2="10.01" y2="12"/><line x1="14" y1="12" x2="14.01" y2="12"/><line x1="18" y1="12" x2="18.01" y2="12"/><line x1="6" y1="16" x2="18" y2="16"/></svg>
  </button>

  <!-- 마커 색상 팝업 메뉴 -->
  <div class="marker-popup" id="markerPopup" style="display: none;">
    <div class="marker-popup-content">
      <div class="marker-popup-row">
        <label class="marker-popup-label">색상</label>
        <div class="marker-color-picker" id="markerColorPicker">
          <button class="marker-color-btn" data-color="default" title="기본" style="background: #4a9eff;"></button>
          <button class="marker-color-btn" data-color="yellow" title="노랑" style="background: #ffdd59;"></button>
          <button class="marker-color-btn" data-color="red" title="빨강" style="background: #ff5555;"></button>
          <button class="marker-color-btn" data-color="pink" title="핑크" style="background: #ff6b9d;"></button>
          <button class="marker-color-btn" data-color="green" title="초록" style="background: #2ed573;"></button>
          <button class="marker-color-btn" data-color="gray" title="회색" style="background: #a0a0a0;"></button>
          <button class="marker-color-btn" data-color="white" title="흰색" style="background: #ffffff;"></button>
        </div>
      </div>
    </div>
  </div>

  <!-- 하이라이트 팝업 메뉴 -->
  <div class="highlight-popup" id="highlightPopup" style="display: none;">
    <div class="highlight-popup-content">
      <div class="highlight-popup-row">
        <label class="highlight-popup-label">주석</label>
        <input type="text" class="highlight-popup-input" id="highlightNoteInput" placeholder="메모 입력...">
      </div>
      <div class="highlight-popup-row">
        <label class="highlight-popup-label">색상</label>
        <div class="highlight-color-picker" id="highlightColorPicker">
          <button class="highlight-color-btn" data-color="red" title="빨강" style="background: #ff5555;"></button>
          <button class="highlight-color-btn" data-color="yellow" title="노랑" style="background: #ffdd59;"></button>
          <button class="highlight-color-btn" data-color="green" title="초록" style="background: #2ed573;"></button>
          <button class="highlight-color-btn" data-color="blue" title="파랑" style="background: #4a9eff;"></button>
          <button class="highlight-color-btn" data-color="gray" title="회색" style="background: #a0a0a0;"></button>
          <button class="highlight-color-btn" data-color="white" title="흰색" style="background: #ffffff;"></button>
        </div>
      </div>
      <div class="highlight-popup-actions">
        <button class="highlight-popup-copy" id="highlightCopyBtn">
          <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
          복사
        </button>
        <button class="highlight-popup-delete" id="highlightDeleteBtn">
          <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>
          삭제
        </button>
      </div>
    </div>
  </div>

  <!-- Shortcuts Menu -->
  <div class="shortcuts-menu" id="shortcutsMenu">
    <div class="shortcuts-menu-header">
      <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="4" width="20" height="16" rx="2"/><line x1="6" y1="8" x2="6.01" y2="8"/><line x1="10" y1="8" x2="10.01" y2="8"/><line x1="14" y1="8" x2="14.01" y2="8"/><line x1="18" y1="8" x2="18.01" y2="8"/><line x1="6" y1="12" x2="6.01" y2="12"/><line x1="10" y1="12" x2="10.01" y2="12"/><line x1="14" y1="12" x2="14.01" y2="12"/><line x1="18" y1="12" x2="18.01" y2="12"/><line x1="6" y1="16" x2="18" y2="16"/></svg>
      키보드 단축키
    </div>
    <div class="shortcuts-menu-content">
      <!-- 재생 -->
      <div class="shortcut-category">
        <div class="shortcut-category-title">재생</div>
        <div class="shortcut-row">
          <span class="shortcut-label">재생/정지</span>
          <div class="shortcut-keys"><span class="shortcut-key">Space</span></div>
        </div>
        <div class="shortcut-row">
          <span class="shortcut-label">이전/다음 프레임</span>
          <div class="shortcut-keys"><span class="shortcut-key">←</span><span class="shortcut-key">→</span></div>
        </div>
        <div class="shortcut-row">
          <span class="shortcut-label">10프레임 이동</span>
          <div class="shortcut-keys"><span class="shortcut-key">Shift</span><span class="shortcut-key">←→</span></div>
        </div>
        <div class="shortcut-row">
          <span class="shortcut-label">1초 이동</span>
          <div class="shortcut-keys"><span class="shortcut-key">Ctrl</span><span class="shortcut-key">←→</span></div>
        </div>
        <div class="shortcut-row">
          <span class="shortcut-label">처음/끝으로</span>
          <div class="shortcut-keys"><span class="shortcut-key">Home</span><span class="shortcut-key">End</span></div>
        </div>
      </div>

      <!-- 도구 -->
      <div class="shortcut-category">
        <div class="shortcut-category-title">도구</div>
        <div class="shortcut-row">
          <span class="shortcut-label">그리기 모드 / 브러시</span>
          <div class="shortcut-keys"><span class="shortcut-key" id="hintDrawMode">B</span></div>
        </div>
        <div class="shortcut-row">
          <span class="shortcut-label">지우개 모드</span>
          <div class="shortcut-keys"><span class="shortcut-key">E</span></div>
        </div>
        <div class="shortcut-row">
          <span class="shortcut-label">댓글 추가</span>
          <div class="shortcut-keys"><span class="shortcut-key" id="hintCommentMode">C</span></div>
        </div>
        <div class="shortcut-row">
          <span class="shortcut-label">선택 모드 (그리기 종료)</span>
          <div class="shortcut-keys"><span class="shortcut-key">V</span></div>
        </div>
      </div>

      <!-- 키프레임 -->
      <div class="shortcut-category">
        <div class="shortcut-category-title">키프레임 (그리기 모드)</div>
        <div class="shortcut-row">
          <span class="shortcut-label">이전/다음 키프레임</span>
          <div class="shortcut-keys"><span class="shortcut-key">A</span><span class="shortcut-key">D</span></div>
        </div>
        <div class="shortcut-row">
          <span class="shortcut-label">어니언 스킨 토글</span>
          <div class="shortcut-keys"><span class="shortcut-key">1</span></div>
        </div>
        <div class="shortcut-row">
          <span class="shortcut-label">빈 키프레임 삽입</span>
          <div class="shortcut-keys"><span class="shortcut-key">2</span></div>
        </div>
        <div class="shortcut-row">
          <span class="shortcut-label">프레임 삽입 (홀드)</span>
          <div class="shortcut-keys"><span class="shortcut-key">3</span></div>
        </div>
        <div class="shortcut-row">
          <span class="shortcut-label">프레임 삭제</span>
          <div class="shortcut-keys"><span class="shortcut-key">4</span></div>
        </div>
      </div>

      <!-- 편집 -->
      <div class="shortcut-category">
        <div class="shortcut-category-title">편집</div>
        <div class="shortcut-row">
          <span class="shortcut-label">실행 취소</span>
          <div class="shortcut-keys"><span class="shortcut-key">Ctrl</span><span class="shortcut-key">Z</span></div>
        </div>
        <div class="shortcut-row">
          <span class="shortcut-label">다시 실행</span>
          <div class="shortcut-keys"><span class="shortcut-key">Ctrl</span><span class="shortcut-key">Y</span></div>
        </div>
        <div class="shortcut-row">
          <span class="shortcut-label">키프레임 복제 추가</span>
          <div class="shortcut-keys"><span class="shortcut-key">F6</span></div>
        </div>
        <div class="shortcut-row">
          <span class="shortcut-label">빈 키프레임 추가</span>
          <div class="shortcut-keys"><span class="shortcut-key">F7</span></div>
        </div>
      </div>
      <div class="shortcut-category">
        <div class="shortcut-category-title">보기 (공통)</div>
        <div class="shortcut-row">
          <span class="shortcut-label">타임라인 줌</span>
          <div class="shortcut-keys"><span class="shortcut-key">Ctrl</span><span class="shortcut-key">+/-</span></div>
        </div>
        <div class="shortcut-row">
          <span class="shortcut-label">단축키 메뉴</span>
          <div class="shortcut-keys"><span class="shortcut-key">?</span></div>
        </div>
      </div>
      <div class="shortcut-category">
        <div class="shortcut-category-title">구간 반복 (공통)</div>
        <div class="shortcut-row">
          <span class="shortcut-label">시작점 설정</span>
          <div class="shortcut-keys"><span class="shortcut-key">I</span></div>
        </div>
        <div class="shortcut-row">
          <span class="shortcut-label">종료점 설정</span>
          <div class="shortcut-keys"><span class="shortcut-key">O</span></div>
        </div>
        <div class="shortcut-row">
          <span class="shortcut-label">구간 반복 토글</span>
          <div class="shortcut-keys"><span class="shortcut-key">L</span></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast Container -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- Scripts -->
  <!-- User Settings Modal -->
  <div class="modal-overlay" id="userSettingsModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>사용자 설정</h3>
        <button class="modal-close" id="closeUserSettings">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="userNameInput">표시 이름</label>
          <input type="text" id="userNameInput" placeholder="댓글에 표시될 이름을 입력하세요" maxlength="20">
          <p class="form-hint">이 이름은 댓글 작성 시 표시됩니다.</p>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary" id="cancelUserSettings">취소</button>
        <button class="btn-primary" id="saveUserSettings">저장</button>
      </div>
    </div>
  </div>

  <!-- 단축키 설정 Modal -->
  <div class="modal-overlay" id="shortcutSettingsModal">
    <div class="modal-content modal-lg">
      <div class="modal-header">
        <h3>단축키 설정</h3>
        <button class="modal-close" id="closeShortcutSettings">&times;</button>
      </div>
      <div class="modal-body">
        <!-- 프레임/초 이동 설정 -->
        <div class="skip-settings-section">
          <div class="skip-settings-title">이동량 설정</div>
          <div class="skip-settings-row">
            <label for="frameSkipInput">Shift+화살표 이동 프레임 수</label>
            <div class="skip-input-group">
              <input type="number" id="frameSkipInput" min="1" max="100" value="10">
              <span class="skip-unit">프레임</span>
            </div>
          </div>
          <div class="skip-settings-row">
            <label for="secondSkipInput">Ctrl+화살표 이동 초</label>
            <div class="skip-input-group">
              <input type="number" id="secondSkipInput" min="0.1" max="10" step="0.1" value="1">
              <span class="skip-unit">초</span>
            </div>
          </div>
        </div>
        <div class="shortcut-list" id="shortcutList">
          <!-- JS에서 렌더링 -->
        </div>
        <p class="form-hint">변경하려는 단축키를 클릭한 후 새로운 키 조합을 입력하세요.</p>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary" id="resetAllShortcuts">기본값으로 초기화</button>
        <button class="btn-primary" id="closeShortcutSettingsBtn">닫기</button>
      </div>
    </div>
  </div>

  <!-- Cache Settings Modal -->
  <div class="modal-overlay" id="cacheSettingsModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>캐시 설정</h3>
        <button class="modal-close" id="closeCacheSettings">&times;</button>
      </div>
      <div class="modal-body">
        <!-- 썸네일 캐시 -->
        <div class="cache-section">
          <div class="cache-section-header">
            <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
            <span>썸네일 캐시</span>
          </div>
          <div class="cache-info">
            <span class="cache-label">현재 사용량</span>
            <span class="cache-value" id="thumbnailCacheSize">계산 중...</span>
          </div>
          <button class="btn-secondary btn-sm" id="btnClearThumbnailCache">썸네일 캐시 비우기</button>
        </div>

        <!-- 트랜스코딩 캐시 -->
        <div class="cache-section">
          <div class="cache-section-header">
            <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><polygon points="23 7 16 12 23 17 23 7"/><rect x="1" y="5" width="15" height="14" rx="2" ry="2"/></svg>
            <span>트랜스코딩 캐시</span>
          </div>
          <div class="cache-info">
            <span class="cache-label">현재 사용량</span>
            <span class="cache-value" id="transcodeCacheSize">계산 중...</span>
          </div>
          <div class="cache-info">
            <span class="cache-label">용량 제한</span>
            <div class="cache-limit-control">
              <input type="range" id="cacheLimitSlider" min="1" max="50" value="10" step="1">
              <span class="cache-limit-value" id="cacheLimitValue">10 GB</span>
            </div>
          </div>
          <p class="form-hint">용량 제한 초과 시 오래된 캐시가 자동 삭제됩니다.</p>
          <button class="btn-secondary btn-sm" id="btnClearTranscodeCache">트랜스코딩 캐시 비우기</button>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-danger btn-sm" id="btnClearAllCache">전체 캐시 비우기</button>
        <button class="btn-primary" id="closeCacheSettingsBtn">닫기</button>
      </div>
    </div>
  </div>

  <!-- Credits Modal -->
  <div class="credits-overlay" id="creditsOverlay">
    <canvas class="credits-plexus" id="creditsPlexus"></canvas>
    <div class="credits-modal">
      <button class="credits-close" id="creditsClose">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
      <div class="credits-content">
        <img class="credits-logo-img" src="assets/logo/baeframe.png" alt="BAEFRAME">
        <div class="credits-logo">
          <span class="credits-logo-b">B</span>
          <span class="credits-logo-text">AE Frame.</span>
        </div>
        <div class="credits-studio">
          <span class="credits-studio-label">Studio</span>
          <span class="credits-studio-name">JBBJ</span>
        </div>
        <div class="credits-divider"></div>
        <div class="credits-people">
          <div class="credits-person">
            <span class="credits-role">powered by</span>
            <span class="credits-name">_배한솔</span>
          </div>
          <div class="credits-person">
            <span class="credits-role">thanks to</span>
            <span class="credits-name">_윤성원</span>
          </div>
        </div>
        <div class="credits-version" id="creditsVersion">v1.0.0</div>
      </div>
    </div>
  </div>

  <!-- Thread Popup Modal -->
  <div class="thread-overlay" id="threadOverlay">
    <div class="thread-modal">
      <div class="thread-header">
        <button class="thread-back" id="threadBack">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15 18 9 12 15 6"/>
          </svg>
        </button>
        <div class="thread-title">
          <span class="thread-title-text">스레드</span>
          <span class="thread-author" id="threadAuthor"></span>
        </div>
        <div class="thread-actions">
          <button class="thread-action-btn" title="설정">
            <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="1"/><circle cx="19" cy="12" r="1"/><circle cx="5" cy="12" r="1"/>
            </svg>
          </button>
          <button class="thread-close" id="threadClose">
            <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </div>
      </div>

      <div class="thread-content" id="threadContent">
        <!-- 원본 댓글 -->
        <div class="thread-original" id="threadOriginal"></div>

        <!-- 답글 개수 -->
        <div class="thread-reply-count" id="threadReplyCount"></div>

        <!-- 답글들 -->
        <div class="thread-replies" id="threadReplies"></div>
      </div>

      <!-- 답글 입력 -->
      <div class="thread-input-area">
        <div class="thread-editor-toolbar">
          <button class="editor-btn" data-format="bold" title="굵게 (Ctrl+B)">
            <strong>B</strong>
          </button>
          <button class="editor-btn" data-format="italic" title="기울임 (Ctrl+I)">
            <em>I</em>
          </button>
          <button class="editor-btn" data-format="underline" title="밑줄 (Ctrl+U)">
            <u>U</u>
          </button>
          <button class="editor-btn" data-format="strike" title="취소선">
            <s>S</s>
          </button>
          <span class="editor-divider"></span>
          <button class="editor-btn" data-format="link" title="링크">
            <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
              <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
            </svg>
          </button>
          <span class="editor-divider"></span>
          <button class="editor-btn" data-format="bullet" title="목록">
            <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/>
              <circle cx="4" cy="6" r="1" fill="currentColor"/><circle cx="4" cy="12" r="1" fill="currentColor"/><circle cx="4" cy="18" r="1" fill="currentColor"/>
            </svg>
          </button>
          <button class="editor-btn" data-format="numbered" title="번호 목록">
            <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="10" y1="6" x2="21" y2="6"/><line x1="10" y1="12" x2="21" y2="12"/><line x1="10" y1="18" x2="21" y2="18"/>
              <text x="2" y="8" font-size="8" fill="currentColor">1</text>
              <text x="2" y="14" font-size="8" fill="currentColor">2</text>
              <text x="2" y="20" font-size="8" fill="currentColor">3</text>
            </svg>
          </button>
          <span class="editor-divider"></span>
          <button class="editor-btn" data-format="code" title="코드">
            &lt;/&gt;
          </button>
          <button class="editor-btn" data-format="codeblock" title="코드 블록">
            <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2"/>
              <polyline points="8 10 5 12 8 14"/><polyline points="16 10 19 12 16 14"/>
            </svg>
          </button>
        </div>
        <div class="thread-image-preview" id="threadImagePreview" style="display: none;">
          <img id="threadPreviewImg" src="" alt="첨부 이미지">
          <button class="thread-image-remove" id="threadImageRemove" title="이미지 제거">
            <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
          </button>
        </div>
        <div class="thread-editor-wrapper">
          <div class="thread-editor"
               id="threadEditor"
               contenteditable="true"
               data-placeholder="댓글 남기기... (Ctrl+V로 이미지 붙여넣기)"></div>
        </div>
        <div class="thread-input-footer">
          <button class="thread-image-btn" id="threadImageBtn" title="이미지 첨부">
            <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><path d="M21 15l-5-5L5 21"/></svg>
          </button>
          <button class="thread-submit" id="threadSubmit">
            <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
              <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Image Viewer Modal -->
  <div class="image-viewer-overlay" id="imageViewerOverlay">
    <div class="image-viewer-content">
      <img class="image-viewer-img" id="imageViewerImg" src="" alt="확대 이미지">
    </div>
    <button class="image-viewer-close" id="imageViewerClose">
      <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
      </svg>
    </button>
  </div>

  <!-- 스플릿 뷰 오버레이 -->
  <div class="split-view-overlay" id="splitViewOverlay">
    <!-- 스플릿 뷰 헤더 (컨트롤 바) -->
    <div class="split-view-header">
      <div class="split-view-mode-controls">
        <button class="split-mode-btn active" id="btnSyncMode" title="동기 재생 - 두 영상이 같은 프레임에서 함께 재생됩니다">
          <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
          </svg>
          동기 재생
        </button>
        <button class="split-mode-btn" id="btnIndependentMode" title="독립 재생 - 각 영상을 개별적으로 제어합니다">
          <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="7" height="7"/>
            <rect x="14" y="14" width="7" height="7"/>
          </svg>
          독립 재생
        </button>
      </div>
      <div class="split-view-actions">
        <button class="split-action-btn" id="btnSwapPanels" title="좌우 패널 교환">
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="7 16 3 12 7 8"/>
            <polyline points="17 8 21 12 17 16"/>
            <line x1="3" y1="12" x2="21" y2="12"/>
          </svg>
        </button>
        <button class="split-action-btn split-close-btn" id="btnCloseSplitView" title="스플릿 뷰 닫기">
          <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- 스플릿 뷰 본체 -->
    <div class="split-view-body">
      <!-- 좌측 패널 (Primary) -->
      <div class="split-panel split-panel-left" id="splitPanelLeft" data-panel="left">
        <div class="split-panel-header">
          <div class="split-version-selector" id="splitVersionSelectorLeft">
            <button class="split-version-trigger" id="splitVersionTriggerLeft">
              <span class="split-version-label" id="splitVersionLabelLeft">v1</span>
              <svg class="split-version-arrow" viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6 9 12 15 18 9"/>
              </svg>
            </button>
            <div class="split-version-menu" id="splitVersionMenuLeft">
              <!-- 버전 목록은 JS에서 동적 생성 -->
            </div>
          </div>
          <div class="split-panel-badge active-badge" id="splitBadgeLeft">활성</div>
          <div class="split-panel-controls">
            <div class="split-volume-control">
              <button class="split-control-btn" id="btnMuteLeft" title="음소거 토글">
                <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2">
                  <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/>
                  <path d="M15.54 8.46a5 5 0 0 1 0 7.07"/>
                  <path d="M19.07 4.93a10 10 0 0 1 0 14.14"/>
                </svg>
              </button>
              <input type="range" class="split-volume-slider" id="volumeSliderLeft" min="0" max="100" value="100" title="볼륨">
            </div>
          </div>
        </div>
        <div class="split-video-container" id="splitVideoContainerLeft">
          <video class="split-video" id="splitVideoLeft"></video>
          <canvas class="split-drawing-canvas" id="splitDrawingCanvasLeft"></canvas>
          <div class="split-loading-overlay" id="splitLoadingLeft">
            <div class="loading-spinner"></div>
            <span>로딩 중...</span>
          </div>
          <div class="split-empty-state" id="splitEmptyLeft">
            <div class="split-empty-icon">📁</div>
            <span>버전을 선택하세요</span>
          </div>
        </div>
      </div>

      <!-- 리사이저 -->
      <div class="split-resizer" id="splitResizer">
        <div class="split-resizer-handle"></div>
      </div>

      <!-- 우측 패널 (Secondary) -->
      <div class="split-panel split-panel-right" id="splitPanelRight" data-panel="right">
        <div class="split-panel-header">
          <div class="split-version-selector" id="splitVersionSelectorRight">
            <button class="split-version-trigger" id="splitVersionTriggerRight">
              <span class="split-version-label" id="splitVersionLabelRight">v2</span>
              <svg class="split-version-arrow" viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6 9 12 15 18 9"/>
              </svg>
            </button>
            <div class="split-version-menu" id="splitVersionMenuRight">
              <!-- 버전 목록은 JS에서 동적 생성 -->
            </div>
          </div>
          <div class="split-panel-badge" id="splitBadgeRight"></div>
          <div class="split-panel-controls">
            <div class="split-volume-control">
              <button class="split-control-btn muted" id="btnMuteRight" title="음소거 토글">
                <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2">
                  <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/>
                  <line x1="23" y1="9" x2="17" y2="15"/>
                  <line x1="17" y1="9" x2="23" y2="15"/>
                </svg>
              </button>
              <input type="range" class="split-volume-slider" id="volumeSliderRight" min="0" max="100" value="0" title="볼륨">
            </div>
          </div>
        </div>
        <div class="split-video-container" id="splitVideoContainerRight">
          <video class="split-video" id="splitVideoRight"></video>
          <canvas class="split-drawing-canvas" id="splitDrawingCanvasRight"></canvas>
          <div class="split-loading-overlay" id="splitLoadingRight">
            <div class="loading-spinner"></div>
            <span>로딩 중...</span>
          </div>
          <div class="split-empty-state" id="splitEmptyRight">
            <div class="split-empty-icon">📁</div>
            <span>버전을 선택하세요</span>
          </div>
        </div>
      </div>
    </div>

    <!-- 스플릿 뷰 공유 타임라인 (동기 모드) -->
    <div class="split-view-timeline" id="splitViewTimeline">
      <div class="split-playback-controls">
        <button class="control-btn" id="splitBtnFirst" title="처음으로">
          <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><polygon points="19 20 9 12 19 4 19 20"/><line x1="5" y1="19" x2="5" y2="5"/></svg>
        </button>
        <button class="control-btn" id="splitBtnPrevFrame" title="이전 프레임">
          <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><polygon points="11 19 2 12 11 5 11 19"/><polygon points="22 19 13 12 22 5 22 19"/></svg>
        </button>
        <button class="control-btn play-btn" id="splitBtnPlay" title="재생/일시정지">
          <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" id="splitPlayIcon"><polygon points="5 3 19 12 5 21 5 3"/></svg>
        </button>
        <button class="control-btn" id="splitBtnNextFrame" title="다음 프레임">
          <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 19 22 12 13 5 13 19"/><polygon points="2 19 11 12 2 5 2 19"/></svg>
        </button>
        <button class="control-btn" id="splitBtnLast" title="끝으로">
          <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 4 15 12 5 20 5 4"/><line x1="19" y1="5" x2="19" y2="19"/></svg>
        </button>
      </div>
      <div class="split-seekbar-container">
        <div class="split-seekbar" id="splitSeekbar">
          <div class="split-seekbar-progress" id="splitSeekbarProgress"></div>
          <div class="split-seekbar-handle" id="splitSeekbarHandle"></div>
        </div>
      </div>
      <div class="split-timecode" id="splitTimecode">
        <span id="splitTimecodeCurrent">00:00:00:00</span>
        <span class="split-timecode-sep">/</span>
        <span id="splitTimecodeTotal">00:00:00:00</span>
      </div>
      <div class="split-frame-info" id="splitFrameInfo">24fps · Frame 0</div>
    </div>
  </div>

  <!-- 커스텀 Prompt 모달 -->
  <div class="prompt-modal-overlay" id="promptModalOverlay">
    <div class="prompt-modal">
      <div class="prompt-modal-header">
        <span class="prompt-modal-title" id="promptModalTitle">입력</span>
        <button class="prompt-modal-close" id="promptModalClose">
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
      <div class="prompt-modal-body">
        <label class="prompt-modal-label" id="promptModalLabel">값을 입력하세요:</label>
        <input type="text" class="prompt-modal-input" id="promptModalInput" />
      </div>
      <div class="prompt-modal-footer">
        <button class="btn btn-secondary prompt-modal-cancel" id="promptModalCancel">취소</button>
        <button class="btn btn-primary prompt-modal-confirm" id="promptModalConfirm">확인</button>
      </div>
    </div>
  </div>

  <script type="module" src="scripts/app.js"></script>
</body>
</html>
