# 2026-02-12 QA 체크리스트 - Windows 통합(이슈 #88)

## 범위

- 통합 설치기: `integration/installer/*.ps1`
- sparse package: `integration/package/install-sparse-package.ps1`
- 앱 설정: `Windows 통합 진단/복구` 버튼
- 지원 확장자: `.mp4`, `.mov`, `.avi`, `.mkv`, `.webm`

## 사전 빌드 체크

- [ ] `powershell -ExecutionPolicy Bypass -File .\integration\shell\build-shell.ps1` 실행 시 `BAEFRAME.ContextMenu.comhost.dll`이 생성된다.
- [ ] `integration/package/assets`에 아이콘 파일(`Square44x44Logo.png`, `Square150x150Logo.png`, `StoreLogo.png`)이 존재한다.

## A. 설치/제거

- [ ] `install-integration.ps1` 실행 후 `detect-integration.ps1`에서 `installed=true`가 나온다.
- [ ] `mode`가 `sparse-package` 또는 `legacy-shell` 중 하나로 보고된다.
- [ ] `uninstall-integration.ps1` 실행 후 `detect-integration.ps1`에서 `installed=false`가 나온다.
- [ ] 재설치 시 `installed=true`로 복구된다.

## B. 파일 타입 제한

- [ ] `.mp4/.mov/.avi/.mkv/.webm`에서 메뉴가 보인다.
- [ ] `.txt/.png/.zip`에서는 메뉴가 보이지 않는다.

## C. 실행 흐름

- [ ] 앱 미실행 상태에서 우클릭 열기 -> 앱 실행 + 대상 영상 자동 로드
- [ ] 앱 실행 상태에서 우클릭 열기 -> 기존 창 포커스 + 대상 영상 전환
- [ ] 긴 경로/한글 경로/공백 경로에서 정상 동작

## D. 비정상 케이스

- [ ] 통합 미설치 상태에서도 앱 일반 실행은 정상 동작
- [ ] 설정 > `Windows 통합 진단/복구` 클릭 시 설치기 실행 시도
- [ ] 권한 취소/실패 시 오류 메시지가 사용자에게 표시됨

## 실행 명령

```powershell
# 탐지
powershell -ExecutionPolicy Bypass -File .\integration\installer\detect-integration.ps1

# 설치 (Auto: sparse 우선, 실패 시 legacy fallback)
powershell -ExecutionPolicy Bypass -File .\integration\installer\install-integration.ps1

# 설치 (강제 legacy)
powershell -ExecutionPolicy Bypass -File .\integration\installer\install-integration.ps1 -Mode Legacy

# 설치 (강제 sparse)
powershell -ExecutionPolicy Bypass -File .\integration\installer\install-integration.ps1 -Mode Sparse

# 제거
powershell -ExecutionPolicy Bypass -File .\integration\installer\uninstall-integration.ps1
```
