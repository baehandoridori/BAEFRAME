# 2026-02-12 이슈 #88 접근성업데이트 통합계획

## 문서 목적
- 이 문서는 새 세션에서 바로 구현을 시작할 수 있도록, 접근성 업데이트의 의사결정을 고정한 실행 문서다.
- 목표는 `실행 -> 파일 열기 -> 공유`의 마찰을 줄여서, 파일 우클릭만으로 BAEFRAME 진입을 가능하게 만드는 것이다.

## 왜 (Why)
### 문제 정의
- 현재 사용 흐름은 앱 실행 후 파일을 드롭/열기해야 하므로, 실제 작업 현장에서 진입 단계가 길다.
- Windows 11에서는 기존 레지스트리 우클릭 확장이 주로 `추가 옵션 표시`로 밀리기 때문에, 사용자 체감상 접근성이 낮다.
- 팀 기준 핵심 목표는 “동영상 파일에서 즉시 BAEFRAME 열기”다.

### 이슈 원문 핵심 (#88)
- 바탕화면 오버레이/핫키/우클릭 진입 등 접근성 개선 요구
- 링크 실행 시 로딩 피드백 강화 필요

### 이번 세션에서 확정한 정책
1. Windows 11 **1차 우클릭 메뉴** 노출을 목표로 한다.
2. 최초 통합은 앱 첫 실행 자동 등록이 아니라 **별도 통합 설치기**로 처리한다.
3. 앱 런타임에서는 통합 상태를 매번 체크하지 않는다.
4. 대신 앱 설정에 **수동 진단/복구 버튼**을 제공한다.

## 무엇을 (What)
### 1차 목표 (필수)
- 동영상 파일 우클릭 시 Windows 11 1차 메뉴에서 BAEFRAME 항목 노출
- 대상 확장자: `.mp4`, `.mov`, `.avi`, `.mkv`, `.webm`
- V1 동작: `BAEFRAME로 열기` 단일 액션

### 2차 목표 (후속)
- 우클릭 공유 액션 확장 (`링크 복사`, `공유 준비`) 검토
- 로딩창 고도화(명언/상태 문구 로테이션 강화)
- 작은 드롭 위젯(크기/불투명도 조절) 옵션화

### 비목표 (이번 작업 범위 밖)
- Slack 드롭 이벤트를 직접 후킹해 시스템 레벨로 가로채는 기능
- BAEFRAME 본앱 실행 시 자동 부트스트랩 설치

## 어떻게 (How)
### 아키텍처 결정
### A. 통합 설치기(별도 실행 파일)
- 이름(가칭): `BAEFRAME-Integration-Setup.exe`
- 역할:
1. 통합 구성요소 설치/업데이트/제거
2. 설치 로그 기록
3. Explorer 반영 안내(필요 시)
- 장점:
1. 본앱 시작 성능/안정성 보존
2. 권한 요청/오류 처리를 설치 단계로 분리
3. 재설치/롤백 경로 명확화

### B. Windows 11 1차 메뉴 확장 경로
- 기본 방향: `IExplorerCommand + App Identity(패키지)` 기반
- 비패키지 Electron 앱은 **Sparse 패키지**로 아이덴티티를 부여해 메뉴 확장을 연결
- 통합 설치기는 이 패키지 등록/해제를 담당

### C. 본앱 연계 방식
- 우클릭 액션은 결국 BAEFRAME 실행 파일에 파일 경로 인자를 전달한다.
- 현재 `main/index.js`가 `process.argv`로 영상 경로 인자를 이미 처리하므로, 기존 진입 로직을 재사용한다.
- 런타임 매 실행 체크는 하지 않는다.

### 구현 단위 (Decision Complete)
#### 1) 통합 설치기 프로젝트 신설
### 디렉터리 제안
```text
integration/
  installer/
    install-integration.ps1
    uninstall-integration.ps1
    detect-integration.ps1
    README.md
  package/
    AppxManifest.xml
    assets/
  shell/
    (IExplorerCommand 구현 바이너리 소스)
```

### 설치기 기능 명세
1. OS 검사: Windows 11 빌드 확인
2. 기존 통합 상태 검사
3. 패키지/확장 등록
4. 실패 시 롤백 또는 재시도 가이드
5. 결과 로그 저장 (`%APPDATA%\\baeframe\\integration-setup.log`)

#### 2) 우클릭 노출 규칙
1. 파일 타입이 영상 확장자일 때만 메뉴 표시
2. 폴더/다중 선택/비지원 확장자에서는 메뉴 숨김 (V1)
3. 메뉴 라벨: `BAEFRAME로 열기`

#### 3) BAEFRAME 호출 규칙
1. 전달 인자: 절대 파일 경로 1개
2. 실행 중 인스턴스가 있으면 기존 `second-instance` 경로로 포커스 + 파일 열기
3. 실행 중이 아니면 앱 시작 후 자동 로드

#### 4) 앱 내 복구 진입점
### 설정 메뉴에 추가
- 버튼: `Windows 통합 진단/복구`
- 동작:
1. 통합 설치기 실행 파일 존재 여부 확인
2. 설치기 실행(관리자 권한 필요 시 승격 안내)
3. 완료 후 결과 메시지 표시

### 주의
- 앱 자동 체크는 하지 않는다.
- 사용자가 명시적으로 누를 때만 통합 상태 확인/복구를 수행한다.

#### 5) 문서/배포 동기화
1. `README.md`에 통합 설치 절차 섹션 추가
2. QA 체크리스트 문서 추가
3. 릴리즈 노트에 “Windows 11 1차 우클릭 지원(통합 설치 필요)” 명시

### 상세 작업 순서
#### Phase 1. 설계/골격
1. 통합 설치기 구조 생성
2. 패키지 매니페스트/확장 연결 정의
3. 영상 확장자 필터 정의

#### Phase 2. 연동 구현
1. 메뉴 클릭 시 파일 경로 전달 구현
2. BAEFRAME 인자 수신 흐름 검증
3. 설정의 수동 복구 버튼 연결

#### Phase 3. 검증/배포
1. 설치/복구/제거 시나리오 테스트
2. Explorer 반영 지연 케이스 점검
3. 파일 타입 노출 조건 검증
4. 사내 배포 및 사용성 피드백 수집

### 테스트 케이스 (수용 기준)
#### A. 설치/제거
1. 통합 설치기 실행 후 Windows 11 1차 우클릭에 BAEFRAME 메뉴가 노출된다.
2. 통합 제거 후 메뉴가 사라진다.
3. 재설치 시 정상 복구된다.

#### B. 파일 타입 제한
1. `.mp4/.mov/.avi/.mkv/.webm`에서만 메뉴가 보인다.
2. `.txt/.png/.zip`에서는 메뉴가 보이지 않는다.

#### C. 실행 흐름
1. 앱 미실행 상태에서 우클릭 열기 -> 앱 실행 + 대상 영상 자동 로드
2. 앱 실행 상태에서 우클릭 열기 -> 기존 창 포커스 + 대상 영상 전환
3. 긴 경로/한글 경로/공백 경로에서 정상 동작

#### D. 비정상 케이스
1. 설치 누락 상태에서 앱은 정상 실행된다.
2. 사용자가 설정의 `진단/복구`를 누르면 통합 설치기가 실행된다.
3. 권한 부족/설치 실패 시 사용자 메시지가 명확하다.

### 리스크와 대응
1. Windows 정책/보안 설정으로 설치 실패 가능
   - 대응: 설치 로그 + 복구 가이드 + 관리자 실행 안내
2. Explorer 반영 지연
   - 대응: 설치 완료 시 반영 안내(Explorer 재시작 필요 여부 표시)
3. 메뉴 과다 노출/중복
   - 대응: V1은 단일 액션으로 제한

### 운영/릴리즈 계획
1. 내부 파일럿 배포 (소수 사용자)
2. 피드백 수집 후 우클릭 액션 확장 여부 결정
3. 후속으로 로딩창 명언 로테이션/위젯 옵션화 진행

### 후속 백로그 (이번 문서 범위 밖이지만 확정된 방향)
#### 1) 로딩창 고도화
- 현재 로딩창 흐름 위에 “배프레임 실행 중” 메시지와 명언 로테이션 강화
- 컨텍스트별 문구 분리(일반 실행/딥링크 실행)

#### 2) 작은 드롭 위젯(옵션 기능)
- 조건: 우클릭 통합이 조직 환경에서 제약이 클 때 차선책으로 도입
- 설정값: 크기, 불투명도, 항상 위

### 구현 시작 체크리스트
- [x] 통합 설치기 프로젝트 폴더 생성
- [x] 패키지/확장 샘플 연결
- [x] 영상 확장자 필터 반영
- [x] 앱 설정에 `진단/복구` 버튼 추가
- [x] README/QA 문서 갱신
- [ ] 내부 파일럿 배포

### 참고
- 이 계획의 우선순위는 “우클릭 즉시 진입”이며, 위젯은 우선순위 2다.
- 설치형 통합은 별도 실행 파일 1회 수행을 전제로 한다.
