# 그리기 모드에서 댓글 마커 클릭 충돌 문제

## 날짜
2026-01-13

## 증상
- 그리기 모드에서 캔버스에 그리는 중, 가끔 손가락 커서(pointer)로 변경됨
- 이 상태에서 클릭하면 멀리 있는 댓글 마커가 클릭되어버림
- 그리기 작업이 의도치 않게 중단되고 마커 인터랙션이 발생

## 원인 분석

### z-index 구조
```
#drawingCanvas (drawing-overlay)     → z-index: 3
.comment-markers-container           → z-index: 15
.comment-marker                      → z-index: 20
```

### pointer-events 설정
```css
/* 기본 상태 */
.drawing-overlay {
  pointer-events: none;
}

/* 활성화 상태 */
.drawing-overlay.active {
  pointer-events: auto;
  cursor: crosshair;
}

/* 댓글 마커 */
.comment-marker {
  pointer-events: auto;  /* 항상 클릭 가능 */
}
```

### 문제점
1. 그리기 캔버스(`z-index: 3`)보다 댓글 마커(`z-index: 20`)가 위에 있음
2. 그리기 모드가 활성화되어도 댓글 마커의 `pointer-events: auto` 유지
3. 마우스가 마커 위를 지나갈 때 마커가 이벤트를 가로챔
4. CSS의 `cursor: crosshair`가 마커의 `cursor: pointer`로 덮어씌워짐

## 해결 방법

### 방법 1: CSS로 해결 (선택)
그리기 오버레이가 활성화되면 같은 컨테이너 내 댓글 마커 비활성화:
```css
/* 그리기 모드에서 댓글 마커 클릭 방지 */
.comment-markers-container.drawing-active .comment-marker {
  pointer-events: none;
}
```

### 방법 2: JavaScript로 해결
`toggleDrawMode()` 함수에서 마커 컨테이너의 pointer-events 제어:
```javascript
function toggleDrawMode() {
  state.isDrawMode = !state.isDrawMode;
  // ... 기존 코드 ...
  markerContainer.classList.toggle('drawing-active', state.isDrawMode);
}
```

## 구현
- `toggleDrawMode()` 함수에서 `markerContainer`에 `drawing-active` 클래스 토글
- CSS에서 `.drawing-active .comment-marker`에 `pointer-events: none` 적용

## 테스트
1. 그리기 모드 활성화
2. 댓글 마커가 있는 위치 위로 마우스 이동
3. 커서가 crosshair 유지되는지 확인
4. 클릭 시 그리기 동작이 정상 수행되는지 확인
5. 그리기 모드 비활성화 후 마커 클릭 정상 동작 확인

## 관련 파일
- `renderer/scripts/app.js` - toggleDrawMode(), markerContainer
- `renderer/styles/main.css` - .comment-marker, .drawing-overlay
